
import numpy as np
import matplotlib.pyplot as plt
import eigen_v


#
# Utilities to plot results from simulations
#



# Increase font size on figures
plt.rcParams.update({'font.size': 12})


# The following snippet can be obtained by directly pasting the result of the clipboard after clicking 'Capture velocity profile data' in the index.html
# Uncomment a single group to generate the plot for the corresponding t value

# t = 10
# y = [-20, -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5, 16.5, 17.5, 18.5, 19.5, 20]
# u_x = np.array([0, 1.909465062600346e-7, 3.0765830896232747e-7, 3.746973112795146e-7, 4.144673942435604e-7, 4.336316492571167e-7, 4.4502222082273004e-7, 4.485678113625104e-7, 4.513324653125159e-7, 4.5340069226227427e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.5340069227301226e-7, 4.513324653267371e-7, 4.485678113625104e-7, 4.450222208191739e-7, 4.33631649302972e-7, 4.1446739424709846e-7, 3.746973112619781e-7, 3.076583089834379e-7, 1.909465062740004e-7, 0])

# t = 50
# y = [-20, -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5, 16.5, 17.5, 18.5, 19.5, 20]
# u_x = np.array([0, 3.742203212822172e-7, 8.200173013316952e-7, 0.0000011840867643200606, 0.0000014776072607164945, 0.0000017117655121423883, 0.0000018957482876454713, 0.0000020390384439164732, 0.0000021486727995208956, 0.000002232011387816541, 0.0000022940634612566642, 0.0000023400979570019257, 0.0000023734154131257864, 0.0000023975294495050755, 0.000002414456033398526, 0.0000024263837811638396, 0.0000024344471555565087, 0.000002439915447919336, 0.0000024433649753525634, 0.000002445442387187463, 0.00000244638262157586, 0.0000024463826215863733, 0.000002445442387243491, 0.0000024433649753735757, 0.000002439915447919336, 0.000002434447155581035, 0.000002426383781174355, 0.0000024144560334020412, 0.000002397529449529606, 0.0000023734154131503178, 0.0000023400979569844107, 0.0000022940634612251398, 0.0000022320113878025467, 0.000002148672799499895, 0.000002039038443878024, 0.0000018957482876559546, 0.0000017117655121563495, 0.0000014776072606920642, 0.000001184086764327037, 8.200173013072875e-7, 3.7422032132403296e-7, 0])

t = 400
y = [-20, -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5, 16.5, 17.5, 18.5, 19.5, 20]
u_x = np.array([0, 8.614997690332093e-7, 0.000002283787013609288, 0.0000036105119272781395, 0.00000484457821793657, 0.000005988886314055428, 0.000007046211391926124, 0.00000801932145630583, 0.000008910801788372879, 0.000009723216988965204, 0.000010458904627237662, 0.0000111201592784009, 0.000011709017726648297, 0.000012227444664836512, 0.000012677129311216116, 0.000013059655265435157, 0.00001337632508917699, 0.000013628300136167197, 0.000013816466029918265, 0.000013941531800615655, 0.000014003945489484924, 0.00001400394548951986, 0.000013941531800636677, 0.000013816466029876334, 0.000013628300136181215, 0.000013376325089204968, 0.000013059655265431642, 0.000012677129311191663, 0.000012227444664840029, 0.00001170901772664129, 0.000011120159278393934, 0.000010458904627241159, 0.000009723216989000202, 0.00000891080178839384, 0.000008019321456354784, 0.000007046211391985576, 0.0000059888863141359, 0.000004844578218024021, 0.0000036105119273376084, 0.0000022837870136897434, 8.614997690786902e-7, 0])

# t = 1000
# y = [-20, -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5, 16.5, 17.5, 18.5, 19.5, 20]
# u_x = np.array([0, 0.0000010622564814268061, 0.0000028866512752792708, 0.000004611745052329688, 0.000006237999731578855, 0.000007765870086124675, 0.000009195800912128103, 0.00001052822431959027, 0.000011763557027065042, 0.000012902197836785351, 0.00001394452512623096, 0.000014890894566022483, 0.00001574163687347812, 0.000016497055825708068, 0.00001715742633510828, 0.00001772299280205994, 0.000018193967563422713, 0.00001857052962239286, 0.000018852823510564352, 0.0000190409584247487, 0.000019135007531733265, 0.00001913500753172283, 0.00001904095842473466, 0.00001885282351056786, 0.00001857052962237186, 0.000018193967563426193, 0.000017722992802046005, 0.000017157426335073227, 0.000016497055825711544, 0.000015741636873499136, 0.000014890894566018973, 0.000013944525126258972, 0.00001290219783676089, 0.000011763557027082567, 0.00001052822431960425, 0.0000091958009121526, 0.000007765870086159662, 0.000006237999731599853, 0.000004611745052364665, 0.000002886651275296763, 0.0000010622564814338003, 0])

# t = 2000
# y = [-20, -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5, 16.5, 17.5, 18.5, 19.5, 20]
# u_x = np.array([0, 0.0000010982516699738777, 0.000002994749536561069, 0.000004791279781491844, 0.000006487863801968326, 0.000008084522663436183, 0.000009581276969872623, 0.00001097814673678185, 0.000012275151267517769, 0.000013472309034426847, 0.000014569637564844097, 0.000015567153333035307, 0.00001646487165873099, 0.00001726280661247808, 0.00001796097092887358, 0.000018559375928135043, 0.0000190580314463082, 0.000019456945774454963, 0.00001975612560758086, 0.00001995557600355741, 0.00002005530035157386, 0.00002005530035157386, 0.000019955576003546873, 0.000019756125607601857, 0.000019456945774468898, 0.00001905803144632224, 0.000018559375928170076, 0.000017960970928887617, 0.000017262806612502575, 0.00001646487165873798, 0.000015567153333035307, 0.000014569637564812604, 0.000013472309034444347, 0.000012275151267531733, 0.000010978146736802861, 0.00000958127696990409, 0.000008084522663418699, 0.000006487863801950835, 0.000004791279781540836, 0.000002994749536571567, 0.0000010982516699528852, 0])

# - End of pasted snippets -


# Compute analytical results in discrete steps
y_lin = np.linspace(y[0], y[len(y) - 1], len(y) * 10)
u_x_a = eigen_v.u_x(y_lin, t)
u_x_inf = 2e-5 - 5e-8 * y_lin ** 2

# Plot data
plt.figure('t = ' + str(t), figsize=(5.75, 6))
plt.plot(u_x_a / 2e-5, y_lin, '-', label=r'$u_x$')
plt.plot(u_x_inf / 2e-5, y_lin, 'k--', label=r'$u_x^{\infty}$', alpha=0.5)
plt.plot(u_x / 2e-5, y, 'r+', label=r'$u_x^{LBM}$')
plt.legend()
plt.ylabel(r'$y$ (lattice constants)')
plt.xlabel(r'$\frac{velocity}{2 \times 10^{-5}}$')

# Auto-generated max velocities at various time-steps
velocities = [0, 0.0000024463826215863682, 0.000004835599960464384, 0.0000069738458324549756, 0.000008834684428318178, 0.00001043674051100514, 0.00001181159719092598, 0.000012991627949987935, 0.000014003945489519874, 0.000014871920512076276, 0.000015616296381910727, 0.00001625476306419426, 0.00001680230560784447, 0.00001727185879853915, 0.000017674560424575315, 0.000018019926543047403, 0.00001831611149538636, 0.00001857012114531806, 0.000018787963355521025, 0.000018974786704345973, 0.000019135007531733296, 0.000019272414322325785, 0.00001939025565494477, 0.000019491317323770257, 0.000019577988628323475, 0.00001965231868219845, 0.00001971606476303125, 0.000019770733928661652, 0.000019817618662074153, 0.000019857827403553654, 0.000019892310755961723, 0.000019921883966456553, 0.0000199472461994108, 0.000019968997062738663, 0.000019987650784877427, 0.000020003648372995665, 0.000020017368038383, 0.000020029134138201497, 0.00002003922484380626, 0.00002004787871727025, 0.00002005530035157387]
labels = [0, 50, 100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000, 1050, 1100, 1150, 1200, 1250, 1300, 1350, 1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 1900, 1950, 2000]
t_vals = np.linspace(0, labels[len(labels)-1], 500)
u_x_vals = eigen_v.u_x(0, t_vals)
plt.figure('max_vel_by_timestep', figsize=(10, 8))
plt.plot(t_vals, u_x_vals, '-', label=r'$u_x$')
plt.plot([0, labels[len(labels) - 1]], [2e-5, 2e-5], 'k--', label=r'$u_x^{\infty}(0)$', alpha=0.5)
plt.plot(labels, velocities, 'r+', label=r'$u_x^{LBM}(0, t)$')
plt.xlabel(r'$t$')
plt.ylabel(r'Velocity at $y=0$')
plt.legend()


plt.show()
