
import numpy as np
import matplotlib.pyplot as plt


# The following snippet can be obtained by directly pasting the result of the clipboard after clicking 'Capture velocity profile data' in the index.html

# t = 10
# y = [-20, -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5, 16.5, 17.5, 18.5, 19.5, 20]
# u_x = np.array([0, 1.909465062600346e-7, 3.0765830896232747e-7, 3.746973112795146e-7, 4.144673942435604e-7, 4.336316492571167e-7, 4.4502222082273004e-7, 4.485678113625104e-7, 4.513324653125159e-7, 4.5340069226227427e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.50000000214168e-7, 4.5340069227301226e-7, 4.513324653267371e-7, 4.485678113625104e-7, 4.450222208191739e-7, 4.33631649302972e-7, 4.1446739424709846e-7, 3.746973112619781e-7, 3.076583089834379e-7, 1.909465062740004e-7, 0])

# t = 50
# y = [-20, -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5, 16.5, 17.5, 18.5, 19.5, 20]
# u_x = np.array([0, 3.742203212822172e-7, 8.200173013316952e-7, 0.0000011840867643200606, 0.0000014776072607164945, 0.0000017117655121423883, 0.0000018957482876454713, 0.0000020390384439164732, 0.0000021486727995208956, 0.000002232011387816541, 0.0000022940634612566642, 0.0000023400979570019257, 0.0000023734154131257864, 0.0000023975294495050755, 0.000002414456033398526, 0.0000024263837811638396, 0.0000024344471555565087, 0.000002439915447919336, 0.0000024433649753525634, 0.000002445442387187463, 0.00000244638262157586, 0.0000024463826215863733, 0.000002445442387243491, 0.0000024433649753735757, 0.000002439915447919336, 0.000002434447155581035, 0.000002426383781174355, 0.0000024144560334020412, 0.000002397529449529606, 0.0000023734154131503178, 0.0000023400979569844107, 0.0000022940634612251398, 0.0000022320113878025467, 0.000002148672799499895, 0.000002039038443878024, 0.0000018957482876559546, 0.0000017117655121563495, 0.0000014776072606920642, 0.000001184086764327037, 8.200173013072875e-7, 3.7422032132403296e-7, 0])

# t = 400
# y = [-20, -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5, 16.5, 17.5, 18.5, 19.5, 20]
# u_x = np.array([0, 8.614997690332093e-7, 0.000002283787013609288, 0.0000036105119272781395, 0.00000484457821793657, 0.000005988886314055428, 0.000007046211391926124, 0.00000801932145630583, 0.000008910801788372879, 0.000009723216988965204, 0.000010458904627237662, 0.0000111201592784009, 0.000011709017726648297, 0.000012227444664836512, 0.000012677129311216116, 0.000013059655265435157, 0.00001337632508917699, 0.000013628300136167197, 0.000013816466029918265, 0.000013941531800615655, 0.000014003945489484924, 0.00001400394548951986, 0.000013941531800636677, 0.000013816466029876334, 0.000013628300136181215, 0.000013376325089204968, 0.000013059655265431642, 0.000012677129311191663, 0.000012227444664840029, 0.00001170901772664129, 0.000011120159278393934, 0.000010458904627241159, 0.000009723216989000202, 0.00000891080178839384, 0.000008019321456354784, 0.000007046211391985576, 0.0000059888863141359, 0.000004844578218024021, 0.0000036105119273376084, 0.0000022837870136897434, 8.614997690786902e-7, 0])

# t = 1500
# y = [-20, -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5, 16.5, 17.5, 18.5, 19.5, 20]
# u_x = np.array([0, 0.0000010918766847165562, 0.00000297560462311473, 0.000004759483002013086, 0.000006443611239494098, 0.000008028087212835762, 0.000009513006655076963, 0.00001089846256428283, 0.000012184544630462171, 0.000013371338682131193, 0.000014458926157082342, 0.00001544738360050691, 0.000016336782192515224, 0.000017127187309392864, 0.00001781865812054115, 0.00001841124722338485, 0.00001890500031910986, 0.000019299955931009225, 0.000019596145166384376, 0.000019793591525525375, 0.000019892310755961683, 0.000019892310755940768, 0.000019793591525525375, 0.000019596145166366958, 0.000019299955930981246, 0.0000189050003191484, 0.000018411247223409354, 0.000017818658120506196, 0.000017127187309354456, 0.00001633678219245927, 0.000015447383600503402, 0.000014458926157089346, 0.000013371338682103207, 0.000012184544630416662, 0.000010898462564310805, 0.000009513006655038527, 0.000008028087212814756, 0.000006443611239455612, 0.000004759483001988613, 0.000002975604623128718, 0.000001091876684695566, 0])

t = 5000
y = [-20, -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5, -9.5, -8.5, -7.5, -6.5, -5.5, -4.5, -3.5, -2.5, -1.5, -0.5, 0.5, 1.5, 2.5, 3.5, 4.5, 5.5, 6.5, 7.5, 8.5, 9.5, 10.5, 11.5, 12.5, 13.5, 14.5, 15.5, 16.5, 17.5, 18.5, 19.5, 20]
u_x = np.array([0, 0.0000010999998260825455, 0.0000029999994777095284, 0.000004799999132613537, 0.00000649999879286906, 0.000008099998460512196, 0.000009599998137781844, 0.000010999997826430682, 0.000012299997528498299, 0.000013499997245849339, 0.000014599996980138393, 0.0000155999967330553, 0.00001649999650607982, 0.000017299996300691817, 0.000017999996118126073, 0.00001859999595949522, 0.00001909999582579623, 0.000019499995717798656, 0.000019799995636188313, 0.000019999995581556343, 0.000020099995554084668, 0.00002009999555409862, 0.000019999995581552843, 0.000019799995636188313, 0.000019499995717784616, 0.00001909999582577868, 0.000018599995959474197, 0.00001799999611811909, 0.00001729999630063934, 0.00001649999650606588, 0.000015599996733030836, 0.000014599996980096458, 0.000013499997245782845, 0.000012299997528431856, 0.00001099999782635724, 0.000009599998137708357, 0.0000080999984604877, 0.0000064999987928235925, 0.000004799999132578534, 0.0000029999994777165223, 0.0000010999998260300702, 0])

# - End of pasted snippets -


# Compute analytical results in discrete steps
y_lin = np.linspace(y[0], y[len(y) - 1], len(y) * 10)
a_u_x = 2e-5 - 5e-8 * y_lin ** 2

# Plot data
plt.figure('t = ' + str(t))
plt.plot(a_u_x / 2e-5, y_lin, 'k--', label='X velocities across the channel (analytical)')
plt.plot(u_x / 2e-5, y, 'r+', label='X velocities across the channel (numerical)')
plt.title('Velocity profile at t = ' + str(t))
plt.legend()
plt.ylabel('y (lattice constants)')
plt.xlabel('velocity in x / 2e-5')

# Auto-generated max velocities at various time-steps
velocities = [0, 0.0000024463826215863682, 0.000004835599960464384, 0.0000069738458324549756, 0.000008834684428318178, 0.00001043674051100514, 0.00001181159719092598, 0.000012991627949987935, 0.000014003945489519874, 0.000014871920512076276, 0.000015616296381910727, 0.00001625476306419426, 0.00001680230560784447, 0.00001727185879853915, 0.000017674560424575315, 0.000018019926543047403, 0.00001831611149538636, 0.00001857012114531806, 0.000018787963355521025, 0.000018974786704345973, 0.000019135007531733296, 0.000019272414322325785, 0.00001939025565494477, 0.000019491317323770257, 0.000019577988628323475, 0.00001965231868219845, 0.00001971606476303125, 0.000019770733928661652, 0.000019817618662074153, 0.000019857827403553654, 0.000019892310755961723, 0.000019921883966456553, 0.0000199472461994108, 0.000019968997062738663, 0.000019987650784877427, 0.000020003648372995665, 0.000020017368038383, 0.000020029134138201497, 0.00002003922484380626, 0.00002004787871727025, 0.00002005530035157387, 0.00002006166520718825, 0.000020067123760583548, 0.000020071805061608457, 0.000020075819784594578, 0.00002007926284451599, 0.000020082215641605963, 0.000020084747984983338, 0.000020086919743926843, 0.000020088782262542857, 0.000020090379574088627, 0.00002009174944177551, 0.000020092924251815917, 0.000020093931778752506, 0.00002009479584216313, 0.000020095536870228974, 0.000020096172382144223, 0.00002009671740249674, 0.00002009718481641444, 0.00002009758567454873, 0.000020097929453880737]
labels = [0, 50, 100, 150, 200, 250, 300, 350, 400, 450, 500, 550, 600, 650, 700, 750, 800, 850, 900, 950, 1000, 1050, 1100, 1150, 1200, 1250, 1300, 1350, 1400, 1450, 1500, 1550, 1600, 1650, 1700, 1750, 1800, 1850, 1900, 1950, 2000, 2050, 2100, 2150, 2200, 2250, 2300, 2350, 2400, 2450, 2500, 2550, 2600, 2650, 2700, 2750, 2800, 2850, 2900, 2950, 3000]
plt.figure('max_vel_by_timestep')
plt.plot([0, labels[len(labels) - 1]], [2e-5, 2e-5], 'k-', label='Analytical maximum X velocity')
plt.plot(labels, velocities, 'r+', label='Numerical maximum X velocity across lattice')
plt.xlabel('t')
plt.ylabel('Maximum velocity across lattice')
plt.legend()


plt.show()
